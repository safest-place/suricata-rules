alert tcp any any -> any any (msg: "识别MySQL流量特征"; flow: to_client, established; content: "mysql_native_password"; flowbits: set, mysql.1000001; flowbits: noalert; classtype: protocol-sign; sid: 1000001; rev: 1;)
alert tcp any any -> any any (msg: "检测到MySQL登录失败"; flow: to_client, established; pcre:"/Access\sdenied\sfor\suser\s'\S+'@'\S+'\s\(using\s\S+:\s\S+\)/"; flowbits: isset, mysql.1000001; flowbits: set, mysql.1000002; flowbits: noalert; classtype: misc-activity; sid: 1000002; rev: 1;)
alert tcp any any -> any any (msg: "检测到MySQL暴力破解行为"; flow: to_client, established; pcre:"/Access\sdenied\sfor\suser\s'\S+'@'\S+'\s\(using\s\S+:\s\S+\)/"; flowbits: isset, mysql.1000002; threshold: type threshold, track by_src, count 200, seconds 30; classtype: misc-activity; sid: 1000003; priority: 3; rev: 1; metadata: description 在30秒内检测到登录失败超过200次;)
alert tcp any any -> any any (msg: "识别Redis登录流量"; flow: to_server, established; pcre:"/^auth\s[A-z0-9]{1,32}\r\n$/"; flowbits: set, redis.1000004; flowbits: noalert; classtype: protocol-sign; sid: 1000004; rev: 1;)
alert tcp any any -> any any (msg: "识别Redis登录失败流量"; flow: to_client, established; pcre:"/-(WRONGPASS|ERR)\sinvalid\s(username)?-?\s?password(\spair\sor\suser\sis\sdisabled.)?\r\n$/"; flowbits: set, redis.1000005; flowbits: noalert; classtype: protocol-sign; sid: 1000005; rev: 1;)
alert tcp any any -> any any (msg: "检测到Redis暴力破解行为"; flow: to_server, established; pcre:"/^auth\s[A-z0-9]{1,32}\r\n$/"; flowbits: isset, redis.1000004; flowbits: isset, redis.1000005; threshold: type threshold, track by_src, count 100, seconds 60; classtype: misc-activity; sid: 1000006; priority: 3; rev: 1; metadata: description 1分钟内登录失败超过100次;)
alert smb any any -> any any (msg: "检测到SMBv1暴力破解行为"; flow: established; content: "|6d 00 00 c0|"; offset: 10; dsize: 76; threshold: type limit, track by_src, count 200, seconds 30; classtype: misc-activity; priority: 3; sid: 1000007; rev: 1; metadata: description 在30秒内检测到登录失败超过200次;)
alert smb any any -> any any (msg: "检测到SMBv2暴力破解行为"; flow: established; content: "|6d 00 00 c0|"; offset: 10; dsize: 39; threshold: type limit, track by_src, count 200, seconds 30; classtype: misc-activity; priority: 3; sid: 1000008; rev: 1; metadata: description 在30秒内检测到登录失败超过200次;)
alert tcp any any -> any any (msg: "检测到Oracle暴力破解行为"; flow: established; content: "ORA-01017: invalid username/password\; logon denied"; threshold: type threshold, track by_dst, count 200, seconds 30; classtype: misc-activity; priority: 3; sid: 1000009; rev: 1; metadata: description 在30秒内连续登录失败超过200次;)
alert tcp any any -> any any (msg: "检测到暴力破解Oracle SID行为"; flow: established; content: "ERROR_STACK=(ERROR=(CODE=12505)"; threshold: type threshold, track by_dst, count 200, seconds 30; classtype: misc-activity; priority: 3; sid: 1000010; rev: 1; metadata: description 在30秒内连续使用错误的SID连接超过200次;)
alert tcp any any -> any any (msg: "检测到FRP工具通信连接"; flow: established; pcre: "/.*\{"version":"\S{5,10}","hostname":"\S{0,}","os":"\w{1,10}","arch":"\w{3,10}","user":"\S{0,10}","privilege_key":"\w{32}","timestamp":\d{10},"run_id":"\S{0,10}","metas":\{\},"pool_count":\d{0,10}\}/"; classtype: post-exploit-tool; priority: 3; sid: 1000011; rev: 1; metadata: description FRP是一款内网穿透工具，使用不当会造成内网资产毫无安全防护地暴露在互联网。;)
alert tcp any any -> any any (msg: "nps TST packet"; flow: established; content: "TST"; depth: 3; dsize: 3; flowbits: set, nps.1000012; flowbits: noalert; classtype: post-exploit-tool; priority: 3; sid: 1000012; rev: 1;)
alert tcp any any -> any any (msg: "nps sucs packet"; flow: established; content: "sucs"; depth: 4; dsize: 4; flowbits: isset, nps.1000012; flowbits: set, nps.1000013; flowbits: noalert; classtype: post-exploit-tool; priority: 3; sid: 1000013; rev: 1;)
alert tcp any any -> any any (msg: "检测到NPS工具通信行为"; flow: established; content: "main"; depth: 4; dsize: 4; flowbits: isset, nps.1000013; classtype: post-exploit-tool; priority: 3; sid: 1000014; rev: 1; metadata: description NPS是一款内网穿透工具，支持SOCKS, HTTP, TCP, UDP多种隧道，在国内入侵案例中较为流行;)
alert tcp any any -> any any (msg: "venom hello packet"; flow: established; content: "ABCDEFGH"; depth: 8; dsize: 8; flowbits: set, venom.1000015; flowbits: noalert; classtype: post-exploit-tool; priority: 3; sid: 1000015; rev: 1;)
alert tcp any any -> any any (msg: "检测到Venom工具通信行为"; flow: established; content: "VCMD"; depth: 4; dsize: 4; flowbits: isset, venom.1000015; classtype: post-exploit-tool; priority: 3; sid: 1000016; rev: 1;)
alert http any any -> any any (msg: "检测到FastTunnel工具通信行为"; flow: established; content: "Upgrade: websocket"; http_header; content: "Connection: Upgrade"; http_header; content: "FT_VERSION:"; http_header; content: "FT_TOKEN:"; http_header; content: "Sec-WebSocket-Version:"; http_header; content: "Sec-WebSocket-Key:"; http_header; classtype: post-exploit-tool; sid: 1000017; rev: 1; metadata: description FastTunnel是.net开发的一款Windows平台内网穿透工具;)
alert tcp any any -> any any (msg: "检测到Stowaway工具通信行为"; flow: established; content: "IAMADMINXDIAMNEWHERE"; content: "THEREISNOROUTE"; classtype: post-exploit-tool; priority: 3; sid: 1000018; rev: 1; metadata: description Stowaway是一款内网穿透工具;)
alert tcp any any -> any any (msg: "检测到Lanproxy工具通信行为"; flow: established; content:"|00 00 00 0a 07 00 00 00 00 00 00 00 00 00|"; depth: 14; dsize: 14; classtype: post-exploit-tool; priority: 3; sid: 1000019; rev: 1; metadata: description Lanproxy是一款内网穿透工具;)
alert tcp any any -> any any (msg: "检测到Termite工具通信行为"; flow: established,to_server; content: "|00 00 00 01|"; offset: 1; depth: 4; content: "|00 00 00 01 6b 00 00 00 01|"; distance: 7; within: 9; content: "agent"; distance: 4; within: 5; reference: url,https://cybersecurity.att.com/blogs/labs-research/internet-of-termites; classtype: post-exploit-tool; sid: 1000020; rev: 2; metadata: description Termite是一款跳板机管理工具;)
alert tcp $HOME_NET any -> any any (msg: "检测到MS17-010漏洞探测行为"; flow:from_server,established; content:"|FF|SMB|32 02 00 00 c0|"; offset:4; depth:9; content:"|52 00|"; distance:21; within:23; classtype:trojan-activity; sid:1000021; rev:1;)
alert tcp any 1433 -> any any (msg: "检测到SQL Server暴力破解行为"; flow: established; content: "|04 01 00 4e|"; depth: 4; content: "|18 48 00 00|"; distance: 7; threshold: type threshold, track by_src, count 60, seconds 10; classtype: misc-activity; priority: 3; sid: 1000022; rev: 1; metadata: description 10秒内登录失败60次;)
alert ftp any any -> any any (msg: "ftp anonymous login"; flow: established; content: "USER anonymous"; flowbits: set, ftp.1000023; flowbits: noalert; classtype: protocol-sign; priority: 3; sid: 1000023; rev: 1;)
alert ftp any any -> any any (msg: "检测到FTP匿名登陆成功行为"; flow: established; content: "230 Login successful."; flowbits: isset, ftp.1000023; classtype: misc-activity; priority: 3; sid: 1000024; rev: 1;)

